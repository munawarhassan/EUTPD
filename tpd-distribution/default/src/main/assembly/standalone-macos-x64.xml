<assembly>
  <id>macos-x64</id>
  <formats>
    <format>tar.gz</format>
  </formats>
  <baseDirectory>${application.name}-mac-x64-${distribution.version}</baseDirectory>

  <fileSets>
    <!-- want to chmod (u+x) the .sh files. to do this we collect the files in seperate filesets so we can chmod just the
      .sh files. -->
    <fileSet>
      <directory>${installed.tomcat.mac-x64.dir}</directory>
      <outputDirectory />
      <includes>
        <include>**/*.sh</include>
      </includes>
      <lineEnding>lf</lineEnding>
      <directoryMode>0755</directoryMode>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <directory>${installed.tomcat.mac-x64.dir}</directory>
      <outputDirectory />
      <excludes>
        <exclude>**/*.sh</exclude>
        <exclude>**/*.bat</exclude>
        <exclude>**/*.cmd</exclude>
        <exclude>**/*.command</exclude>
        <exclude>conf/logging.properties</exclude>
        <exclude>conf/server.xml</exclude>
        <exclude>webapps/**/*</exclude>
        <exclude>RELEASE-*</exclude>
        <exclude>LICENSE</exclude>
        <exclude>README.txt</exclude>
        <exclude>RUNNING.txt</exclude>
        <exclude>NOTICE</exclude>
      </excludes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
    </fileSet>
    <!-- logging.properties is included separately because the concat operations done to configure custom log levels results
      in the file having mixed line endings. This normalizes them -->
    <fileSet>
      <directory>${installed.tomcat.mac-x64.dir}</directory>
      <outputDirectory />
      <includes>
        <include>conf/logging.properties</include>
      </includes>
      <lineEnding>lf</lineEnding>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <directory>${installed.tomcat.mac-x64.dir}</directory>
      <outputDirectory>tomcat-docs</outputDirectory>
      <includes>
        <include>RELEASE-*</include>
        <include>LICENSE</include>
        <include>README.txt</include>
        <include>RUNNING.txt</include>
        <include>NOTICE</include>
      </includes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
    </fileSet>
    <!-- special tomcat config files that we want to overwrite -->
    <fileSet>
      <directory>src/main/tomcat/conf</directory>
      <outputDirectory>conf</outputDirectory>
      <filtered>true</filtered>
      <includes>
        <include>server.xml</include>
        <include>${app.configfile}</include>
      </includes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <directory>src/main/tomcat/bin</directory>
      <outputDirectory>bin</outputDirectory>
      <filtered>true</filtered>
      <includes>
        <include>*.sh</include>
      </includes>
      <lineEnding>lf</lineEnding>
      <directoryMode>0755</directoryMode>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <directory>${db.driver.dir}</directory>
      <outputDirectory>lib</outputDirectory>
      <includes>
        <include>*.jar</include>
      </includes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <directory>${db.driver.dir}</directory>
      <outputDirectory>lib/native</outputDirectory>
      <includes>
        <include>*.dll</include>
      </includes>
      <directoryMode>0755</directoryMode>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <directory>src/main/resources</directory>
      <outputDirectory />
      <filtered>true</filtered>
      <includes>
        <include>README.txt</include>
      </includes>
    </fileSet>
  </fileSets>
  <dependencySets>
    <dependencySet>
      <outputDirectory>bin</outputDirectory>
      <outputFileNameMapping>${artifact.artifactId}.${artifact.extension}</outputFileNameMapping>
      <includes>
        <include>com.pmi.tpd:tpd.tomcat.bootstrap:jar</include>
      </includes>
    </dependencySet>
    <dependencySet>
      <outputDirectory>tpd</outputDirectory>
      <scope>runtime</scope>
      <unpack>true</unpack>
      <includes>
        <include>com.pmi.tpd:tpd.web:war</include>
      </includes>
    </dependencySet>
    <dependencySet>
      <unpack>true</unpack>
      <scope>runtime</scope>
      <outputDirectory>java</outputDirectory>
      <includes>
        <include>net.adoptium:jdk-hotspot:tar.gz:mac-x64:${jdk.version}</include>
      </includes>
    </dependencySet>
  </dependencySets>
</assembly>
